/*! dunelondoncom v1.0.0 | 2025-08-04T12:58:12 | 558c376d4a28a046d90fecb558bf782dfc1f30e4 | Copyright. All rights reserved. 2025. Digital Media Technologies Ltd. */
"use strict";!function(){if("function"==typeof window.CustomEvent)return;function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var a=document.createEvent("CustomEvent");return a.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),a}t.prototype=window.Event.prototype,window.CustomEvent=t}(),function(){function c(){if(!P||0===P.length)return"";var t=P.pop(),e=t&&t.countryId;if(!e)return"";var a=e.toUpperCase();return U.includes(a)?"en-"+a:""}function r(){var t=R[T]||767,e="desktop";return window.innerWidth<=t&&(e="mobile"),e}function o(){return"mobile"===r()}function i(){function t(t){return t&&-1<C.indexOf(t)}var e=taggstar.$("body").data("tagg-insert-function"),a=taggstar.$("body").data("tagg-insert-function-m");return o()&&t(a)&&(e=a),t(e)||(e=$[T][r()]),e}function g(t,e){var a;switch(T){case"category":a=taggstar.$('.taggstar[data-pid="'+t+'"]:first, .product[data-pid="'+t+'"]:first'),e||a.find(".tagg-category-page").remove();break;case"basket":a=taggstar.$('.taggstar[data-variation-group-pid="'+t+'"]:first, .product-info[data-variation-group-pid="'+t+'"]:first'),e||a.find(".tagg-basket-page").remove()}return function(e){function t(t){return t&&N(t,e).length}var a=taggstar.$("body").data("tagg-anchor"),n=taggstar.$("body").data("tagg-anchor-m");return o()&&t(n)&&(a=n),t(a)||(a=A[T][r()]),N(a,e)}(a)}function s(){function a(t){!(1<arguments.length&&void 0!==arguments[1])||arguments[1]?t.attr(e):t.attr("aria-hidden","true")}var e={tabindex:0,"aria-live":"polite"};taggstar.$(".tagg-balloons-wrapper .tagg-txt, .tagg-balloons-wrapper-modal .tagg-txt").each(function(){var t=taggstar.$(this),e=t.find(".tagg-desktop, .tagg-mobile");e.length?e.each(function(){var t=taggstar.$(this);a(t,t.is(":visible"))}):a(t)})}function n(t){var e={},a=taggstar.getVisitor();return e.version=3,e.visitor=a&&a.id,e.module=M.module,M.experienceRequired||t&&t.hasOwnProperty("experiment")&&t.experiment&&(e.experiment={id:t.experiment.id,group:t.experiment.group}),t.action?(e.type="action",e.action=t.action):(e.type="socialProof",e.socialProof=function(t){var e,a,n,r,o,i,c,g=[],s=t.socialProof;if(s)for(e=0;e<s.length;e++)for(n=(r=s[e]).product&&r.product.id,o=r.messages,a=0;a<o.length;a++)c={productId:n,code:(i=o[a]).code,data:i.data,text:i.message},g.push(c);return g}(t)),e}function u(a){return new Promise(function(t){try{var e=new CustomEvent("taggstar:response",{detail:n(a)});document.dispatchEvent(e),taggstar.analytics=taggstar.analytics||[],taggstar.analytics.push({data:n(a),timestamp:Date.now()})}catch(t){taggstar.log("error submitting tracking object")}finally{t(a)}})}function t(){var t,e,a,n,r;for(p=M.experienceRequired?p||taggstar.params&&taggstar.params.taggExperienceId||taggstar.$("body").data("tagg-experience"):void 0,f={category:"-",products:[]},n=(t=document.querySelectorAll(".product-grid .taggstar[data-pid], .product-grid .product[data-pid]")).length,a=0;a<n;a++){var o=t[a];r=o.getAttribute("data-tagg-processed"),(e=o.getAttribute("data-pid"))&&1<e.length&&r!=e&&(f.products.indexOf(e)<0&&f.products.push(e),o.setAttribute("data-tagg-processed",e))}return(!M.experienceRequired||p)&&f.category&&f.products.length&&g(G(f,"products.0"),!0).length}function e(){p=taggstar.params&&taggstar.params.taggExperienceId||taggstar.$("body").data("tagg-experience");var t=window.dataLayer.filter(function(t){return t["gtm.uniqueEventId"]>W&&"Product Details Page"===t.funnelPageType&&t.ecommerce&&t.ecommerce.detail&&t.ecommerce.detail.products});if(t.length){var e=G(t,"0.ecommerce.detail.products.0.id");W=t[0]["gtm.uniqueEventId"],taggstar.log("Executing PDP"),m={id:e,name:"-",price:1,category:"-"}}return(!M.experienceRequired||p)&&m&&m.id&&g().length}function a(){var t,e,n,r,o,a=[],i={};for(M.experienceRequired&&(S.experienceId=p),S.detail=!0,S.locale=c(),Object.keys(S).length&&taggstar.init(S),r={category:f.category},t=0;t<f.products.length;t++)e=f.products[t],B.indexOf(e)<0&&(B.push(e),a.push(e)),L[e]&&(i[e]=L[e]);if(n=parseInt(a.length/100),a.length){taggstar.log(n),f.products=a,r.products=f.products;!function e(t){if(n<t)taggstar.$(".tagg-category-page").fadeIn(800);else if(o=f.products.splice(0,100),(r.products=o).length){var a=function(a,n){return new Promise(function(t,e){taggstar.categoryRequest(a).then(u).then(taggstar.handleResponseMulti).then(function(t){return taggstar.$.extend(L,t),taggstar.$.extend(n,t),V(n)}).then(t).catch(function(t){F(t),e(t)})})}(r,i);0===t?a.then(function(){for(var t=1;t<=n;t++)e(t)}):t===n&&a.then(function(){taggstar.log("All requests completed"),taggstar.$(".tagg-category-page").fadeIn(800)})}}(0)}else V(i)}function d(){M.experienceRequired&&(S.experienceId=p),S.detail=!0,S.locale=c(),Object.keys(S).length&&taggstar.init(S),taggstar.productRequest(m).then(u).then(taggstar.handleProductResponse).then(function(t){var e=function(){var t=1024<window.innerWidth;return{experienceType:"default",taggSticky:!1,customAnimation:t?z:H,showCloseButton:t,delayBetween:t?0:4500,experienceClass:"tagg-experience-1"}}(),a=g().selector;if(taggstar.$(".tagg-product-page").remove(),m=null,0<Object.keys(t).length){if(E&&(clearInterval(E),E=null),q&&(clearInterval(q),q=null),e.taggSticky){var n=taggstar.$('<div class="tagg-sticky"></div>');taggstar.$(g().selector).append(n),a=".tagg-sticky"}taggstar.displayMessageBalloons(t,a,{extraClass:"tagg-product-page tagg-"+j+(1<t.length?" tagg-two-balloons":"")+" "+e.experienceClass,insertFunction:i(),firstDelay:0,customAnimation:e.customAnimation,closeButton:e.showCloseButton,delayBetween:e.delayBetween}).then(function(){s()}).catch(F)}else taggstar.log("No Social Proof returned..."),taggstar.log("Clearing interval...")}).catch(F)}function l(){return!0}var p,f,m,h,y,v,b,w,x,k,I,P,q,E,C=["before","after","prepend","append"],$={category:{desktop:"prepend",mobile:"prepend"},product:{desktop:"append",mobile:"append"},basket:{desktop:"after",mobile:"after"}},A={category:{desktop:".image-container",mobile:".image-container"},product:{desktop:".viewer-wrap",mobile:".viewer-wrap"},basket:{desktop:".line-item-header",mobile:".line-item-header"}},R={category:767,product:767,basket:767},T="",B=[],L={},S={},O=-1,D=-1,M=taggstar.config,j=M.key,F=taggstar.exception.handle,G=taggstar.util.getObjectByPath,W=-1,U=["IE","GB"],_=["en-IE","en-GB"],N=function(t,e){var a;return(a=e?e.is(t)?e:e.find(t):taggstar.$(t)).selector||(a.selector=t),a},V=function(t){taggstar.displayMessageBalloonsMulti(t,g,{wrapperClass:"tagg-balloons-wrapper",extraClass:"tagg-category-page tagg-"+j,insertFunction:i()}).then(function(){s()}).catch(F)},z=function(t,e,a){taggstar.log("custom animation fired");var n=0<taggstar.$(".tagg-balloons-wrapper").find("div.tagg-balloon").length,r={opacity:1};e.css({opacity:0}),taggstar.$(".tagg-balloons-wrapper").append(e),n?(r.opacity=0,q=setInterval(function(){r.opacity=0===r.opacity?1:0,e.css(r),e.prev().css({opacity:1===r.opacity?0:1})},a.hold+500)):setTimeout(function(){t.css({opacity:1}),r.opacity=1,e.css(r)},a.firstDelay);function o(){t.css({opacity:0}),clearInterval(q),setTimeout(function(){t.remove()},1e3)}var i=e.get(0).querySelector(".tagg-x");i&&(i.setAttribute("tabindex",0),i.setAttribute("aria-label","close message balloon"),i.setAttribute("role","button"),i.addEventListener("keydown",function(t){" "!==t.key&&"Enter"!==t.key&&"Spacebar"!==t.key||o()}),i.addEventListener("click",o))},H=function(e,t,a,n){taggstar.log("custom animation hit");var r=e.hasClass("tagg-two-balloons")&&1==n||!e.hasClass("tagg-two-balloons"),o=0<taggstar.$(".tagg-product-page").find("div.tagg-balloon").length,i={opacity:1};t.css({opacity:0}),taggstar.$(".tagg-product-page").append(t),o?(i.opacity=0,E=setInterval(function(){i.opacity=0===i.opacity?1:0,t.css(i),t.prev().css({opacity:1===i.opacity?0:1})},5500)):setTimeout(function(){e.css({opacity:1}),i.opacity=1,t.css(i)},a.firstDelay);setTimeout(function(){t.animate({opacity:1},a.fade,function(){taggstar.keepUI||setTimeout(function(){!function(t){t.animate({opacity:0},a.fade,function(){r&&setTimeout(function(){e.remove()},a.fade+1e3)})}(t),clearInterval(E)},a.hold)})},a.firstDelay)},J={category:{condition:t,module:function(){try{a(),v=setInterval(function(){t()&&a()},3*M.interval)}catch(t){clearInterval(v)}}},product:{condition:e,module:function(){try{b=setInterval(function(){e()&&d()},3*M.interval)}catch(t){clearInterval(b)}}},basket:{condition:function(){return p=M.experienceRequired?p||taggstar.params&&taggstar.params.taggExperienceId||taggstar.$("body").data("tagg-experience"):void 0,h={lineItems:[]},document.querySelectorAll(".taggstar[data-variation-group-pid], .product-info[data-variation-group-pid]").forEach(function(t){var e=t,a=e.getAttribute("tagg-processed"),n=t.getAttribute("data-variation-group-pid");!a&&n&&(h.lineItems.push({id:n,unitPrice:1,quantity:1}),e.setAttribute("tagg-processed",!0))}),(!M.experienceRequired||p)&&h.lineItems.length&&g(G(h,"lineItems.0.id"),!0).length},module:function(){M.experienceRequired&&(S.experienceId=p),S.detail=!0,S.locale=c(),Object.keys(S).length&&taggstar.init(S),taggstar.basketRequest(h).then(u).then(taggstar.handleResponseMulti).then(function(t){taggstar.displayMessageBalloonsMulti(t,g,{extraClass:"tagg-basket-page tagg-"+j,insertFunction:i()}).then(function(){s()}).catch(F)}).catch(F)}},conversion:{condition:function(){var t=G(I,"0.ecommerce.purchase.actionField.id");return!!t&&(y={id:t,currency:G(I,"0.ecommerce.currencyCode"),totalPrice:G(I,"0.ecommerce.purchase.actionField.revenue"),orderItems:[]},(G(I,"0.ecommerce.purchase.products")||[]).forEach(function(t){y.orderItems.push({id:t.id,unitPrice:t.price,category:t.category||"-",quantity:t.quantity})}),console.log("Conversion Layer: "),console.log(I),y.id&&y.currency&&y.totalPrice&&y.orderItems.length)},module:function(){S.currencyCode=y.currency,S.locale=c(),taggstar.init(S),taggstar.conversionRequest(y).then(u).then(function(t){taggstar.log("conversion successful","info"),taggstar.log(t,"info")}).catch(F)}},empty:{condition:l,module:l}};!function(){var t,e,a,n,r=taggstar.util.getCookie("_taggstar_dbg");if(r)for(taggstar.debug=!0,t=r.split("|"),e=0;e<t.length;e++)switch((a=t[e].split(":"))[0]){case"kui":taggstar.keepUI="true"===a[1];break;case"prd":n=a[1];break;case"id":"client"===n&&a[1]&&(taggstar.params.taggExperienceId=a[1]),"server"===n&&a[1]&&(taggstar.params.taggExperimentId=a[1]);break;case"grp":"server"===n&&a[1]&&(taggstar.params.taggExperimentGroup=a[1])}}(),taggstar.boot(function(){return P=window.dataLayer.filter(function(t){return t.funnelPageType&&t.countryId}),w=window.dataLayer.filter(function(t){return"Product Listing Page"===t.funnelPageType||"Product Search Page"===t.funnelPageType}),x=window.dataLayer.filter(function(t){return"Product Details Page"===t.funnelPageType&&t.ecommerce&&t.ecommerce.detail&&t.ecommerce.detail.products}),k=window.dataLayer.filter(function(t){return"Cart Page"===t.funnelPageType&&t.ecommerce&&t.ecommerce.cart&&t.ecommerce.cart.products}),I=window.dataLayer.filter(function(t){return"Confirmation Page"===t.funnelPageType&&t.ecommerce&&t.ecommerce.purchase&&t.ecommerce.purchase.products}),T=_.includes(c())&&(w.length||x.length||k.length||I.length)?0!==document.querySelectorAll(".product-grid .product[data-pid]").length&&w.length?"category":x.length&&G(x,"0.ecommerce.detail.products.0.id")?"product":0!==document.querySelectorAll(".product-info[data-pid]").length&&k.length?"basket":I.length?"conversion":taggstar.constant.null:taggstar.constant.null,taggstar.log(T),T},J).catch(F),setInterval(function(){try{!function(){var t,e,a;if((t=window.dataLayer.filter(function(t){return"addToCart"===t.event&&"Add to Basket"===t.eventAction})).length){var n=t[t.length-1],r=n["gtm.uniqueEventId"];r!==O&&(O=r,a=G(n,"ecommerce.add.products.0"),e={category:"basket",name:"add",data:{label:a.id,value:1}},taggstar.log("submitting wishlist"),taggstar.eventRequest(e).then(function(){delete e.eventGroupId,u({action:e})}).catch(F))}}(),function(){var t,e,a;if((t=window.dataLayer.filter(function(t){return"addToWishlist"===t.event&&t.ecommerce&&t.ecommerce.addToWishlist})).length){var n=t[t.length-1],r=n["gtm.uniqueEventId"];r!==D&&(D=r,a=G(n,"ecommerce.addToWishlist.products.0"),e={category:"wishlist",name:"add",data:{label:a.id,value:1}},taggstar.log("submitting wishlist"),taggstar.eventRequest(e).then(function(){delete e.eventGroupId,u({action:e})}).catch(F))}}()}catch(t){taggstar.log(t)}},1e3)}(window);